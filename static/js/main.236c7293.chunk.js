(this.webpackJsonpanchored=this.webpackJsonpanchored||[]).push([[0],{29:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var i=a(1),c=a.n(i),l=a(7),n=a.n(l),r=a(2),s=a(0),d=function(e){var t=e.handleFileLoad,a=Object(i.useState)(),c=Object(r.a)(a,2),l=c[0],n=c[1];return Object(s.jsx)("form",{className:"d-flex",onSubmit:function(e){if(e.preventDefault(),l){var a=new FileReader;a.onload=function(e){t(JSON.parse(e.target.result))},a.readAsText(l)}else alert("No file selected!")},children:Object(s.jsx)("div",{className:"form-group",children:Object(s.jsxs)("div",{className:"input-group",children:[Object(s.jsx)("input",{type:"file",onChange:function(e){return n(e.target.files[0])},accept:"application/JSON",className:"form-control",id:"inputGroupFile","aria-describedby":"inputGroupFileAddon","aria-label":"Upload",required:!0}),Object(s.jsx)("button",{className:"btn btn-outline-primary",type:"submit",id:"inputGroupFileAddon",children:"Load"})]})})})},o=function(e){var t=e.handleFileLoad;return Object(s.jsx)("header",{className:"p-3 mb-3 border-bottom",children:Object(s.jsx)("div",{className:"container",children:Object(s.jsxs)("div",{className:"d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start",children:[Object(s.jsx)("a",{href:"/",className:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",children:Object(s.jsx)("span",{className:"fs-4",children:"anchored"})}),Object(s.jsx)(d,{handleFileLoad:t})]})})})},j=function(){return Object(s.jsxs)("footer",{className:"d-flex flex-wrap justify-content-between align-items-center py-3 mt-4 border-top",children:[Object(s.jsx)("div",{className:"col-md-4 d-flex align-items-center",children:Object(s.jsx)("span",{className:"text-muted",children:"\xa9 2021 anchored"})}),Object(s.jsx)("ul",{className:"nav col-md-4 justify-content-end list-unstyled d-flex",children:Object(s.jsx)("li",{className:"ms-3",children:Object(s.jsx)("a",{className:"text-muted",href:"https://github.com/HFSVBC/anchored",target:"_blank",rel:"noreferrer",children:Object(s.jsx)("i",{className:"bi-github",role:"img","aria-label":"GitHub",style:{fontSize:"1.75rem"}})})})})]})},m=a(9),b=a.n(m),h={fontSize:"1.75rem"},u=function(e){var t=e.imageMetadata,a=e.matches,c=Object(i.useState)(),l=Object(r.a)(c,2),n=l[0],d=l[1],o=Object(i.useState)(),j=Object(r.a)(o,2),m=j[0],u=j[1];Object(i.useEffect)((function(){var e=t.tags[0].split(":");d(e[1]),u(e[0])}),[t]);var x=function(e){return"".concat(b()("vulnerability",e,!0)," found")};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"row pt-4",children:Object(s.jsxs)("div",{className:"col-md-10",children:[Object(s.jsx)("h5",{className:"mb-0",children:m}),Object(s.jsx)("p",{className:"text-muted",children:"".concat(n," - ").concat(b()("layer",t.layers.length,!0))})]})}),Object(s.jsxs)("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4 py-5",children:[Object(s.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(s.jsx)("i",{className:"bi-exclamation-triangle-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Triangle",style:h}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{className:"fw-bold mb-0",children:"Critical"}),Object(s.jsx)("p",{children:x(a.critical.length)})]})]}),Object(s.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(s.jsx)("i",{className:"bi-exclamation-diamond-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Diamond",style:h}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{className:"fw-bold mb-0",children:"Danger"}),Object(s.jsx)("p",{children:x(a.high.length)})]})]}),Object(s.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(s.jsx)("i",{className:"bi-exclamation-circle-fill text-warning flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Circle",style:h}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{className:"fw-bold mb-0",children:"Medium"}),Object(s.jsx)("p",{children:x(a.medium.length)})]})]}),Object(s.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(s.jsx)("i",{className:"bi-info-square-fill text-muted flex-shrink-0 me-3",role:"img","aria-label":"Info Square",style:h}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{className:"fw-bold mb-0",children:"Low / Negligible"}),Object(s.jsx)("p",{children:x(a.low.length+a.negligible.length)})]})]})]})]})},x=a(3),f={minHeight:"480px",width:"100%"},O={filter:"agTextColumnFilter",resizable:!0},g={severityCell:function(e){var t=e.value,a="text-body";switch(t){case"High":case"Critical":a="text-danger";break;case"Medium":a="text-warning";break;default:a="text-body"}return Object(s.jsx)("span",{className:a,children:t})}},p=function(e){return e.data.artifact.locations[0].layerIndex},N=function(e){var t=e.matches,a=Object(i.useState)(),c=Object(r.a)(a,2),l=c[0],n=c[1];Object(i.useEffect)((function(){n(t.critical.concat(t.high).concat(t.medium).concat(t.low).concat(t.negligible))}),[t]);return Object(s.jsx)("div",{className:"ag-theme-alpine flex-grow-1",style:f,children:Object(s.jsxs)(x.AgGridReact,{rowData:l,paginationAutoPageSize:"true",pagination:"true",defaultColDef:O,frameworkComponents:g,onGridReady:function(e){e.api.sizeColumnsToFit()},children:[Object(s.jsxs)(x.AgGridColumn,{headerName:"Vulnerability",children:[Object(s.jsx)(x.AgGridColumn,{headerName:"ID",field:"vulnerability.id",minWidth:190}),Object(s.jsx)(x.AgGridColumn,{headerName:"Severity",field:"vulnerability.severity",minWidth:120,sortable:"true",cellRenderer:"severityCell"}),Object(s.jsx)(x.AgGridColumn,{headerName:"Description",field:"vulnerability.description",minWidth:500})]}),Object(s.jsxs)(x.AgGridColumn,{headerName:"Artifact",children:[Object(s.jsx)(x.AgGridColumn,{headerName:"Type",field:"artifact.type"}),Object(s.jsx)(x.AgGridColumn,{headerName:"Package",field:"artifact.name"}),Object(s.jsx)(x.AgGridColumn,{headerName:"Version",field:"artifact.version"})]}),Object(s.jsx)(x.AgGridColumn,{headerName:"Layer",children:Object(s.jsx)(x.AgGridColumn,{headerName:"Index",valueGetter:p,sortable:"true",sort:"desc"})})]})})},v=function(){return Object(s.jsxs)("div",{className:"px-4 py-5 my-5 text-center",children:[Object(s.jsxs)("h1",{className:"display-5 fw-bold",children:["Please Load a",Object(s.jsx)("i",{children:" vulnerabilities.json "}),"File"]}),Object(s.jsx)("div",{className:"col-lg-6 mx-auto",children:Object(s.jsxs)("p",{className:"lead mb-4 text-muted",children:["The",Object(s.jsx)("i",{children:" vulnerabilities.json "}),"report is generated by the anchore engine. For more information on the anchore engine please visit:\xa0",Object(s.jsx)("a",{className:"text-muted",href:"https://anchore.com",target:"_blank",rel:"noreferrer",children:"anchore.com"})]})})]})};var y={bytesToSize:function(e){if(0===e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return"".concat(Math.round(e/Math.pow(1024,t),2)," ").concat(["Bytes","KB","MB","GB","TB"][t])},layerMatchesBySeverity:function(e,t){return e.filter((function(e){return e.vulnerability.severity.toLowerCase()===t}))},parseMatches:function(e){var t={negligible:[],low:[],medium:[],high:[],critical:[]};return Object.keys(t).forEach((function(a){t[a]=e.matches.filter((function(e){return e.vulnerability.severity.toLowerCase()===a}))})),t}};a(29);var w=function(){var e=Object(i.useState)(),t=Object(r.a)(e,2),a=t[0],c=t[1],l=Object(i.useState)(),n=Object(r.a)(l,2),d=n[0],m=n[1];return Object(s.jsxs)("main",{className:"App d-flex flex-column",children:[Object(s.jsx)("div",{className:"w-100",children:Object(s.jsx)(o,{handleFileLoad:function(e){c(e.image),m(y.parseMatches(e))}})}),Object(s.jsxs)("div",{className:"container d-flex align-items-end flex-column flex-grow-1",children:[Object(s.jsx)("div",{className:"w-100 h-100 d-flex flex-column",children:a&&d?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(u,{imageMetadata:a,matches:d}),Object(s.jsx)(N,{matches:d})]}):Object(s.jsx)(v,{})}),Object(s.jsx)("div",{className:"w-100 mt-auto",children:Object(s.jsx)(j,{})})]})]})};a(30);n.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(w,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.236c7293.chunk.js.map