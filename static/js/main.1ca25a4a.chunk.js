(this.webpackJsonpanchored=this.webpackJsonpanchored||[]).push([[0],{30:function(e,t,l){},32:function(e,t,l){"use strict";l.r(t);var c=l(1),a=l.n(c),i=l(8),s=l.n(i),n=l(2),r=l(0),d=function(e){var t=e.handleFileLoad,l=Object(c.useState)(),a=Object(n.a)(l,2),i=a[0],s=a[1];return Object(r.jsx)("form",{className:"d-flex",onSubmit:function(e){if(e.preventDefault(),i){var l=new FileReader;l.onload=function(e){t(JSON.parse(e.target.result))},l.readAsText(i)}else alert("No file selected!")},children:Object(r.jsx)("div",{className:"form-group",children:Object(r.jsxs)("div",{className:"input-group",children:[Object(r.jsx)("input",{type:"file",onChange:function(e){return s(e.target.files[0])},accept:"application/JSON",className:"form-control",id:"inputGroupFile","aria-describedby":"inputGroupFileAddon","aria-label":"Upload",required:!0}),Object(r.jsx)("button",{className:"btn btn-outline-primary",type:"submit",id:"inputGroupFileAddon",children:"Load"})]})})})},o=function(e){var t=e.handleFileLoad;return Object(r.jsx)("header",{className:"p-3 mb-3 border-bottom",children:Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)("div",{className:"d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start",children:[Object(r.jsx)("a",{href:"/",className:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",children:Object(r.jsx)("span",{className:"fs-4",children:"anchored"})}),Object(r.jsx)(d,{handleFileLoad:t})]})})})},j=function(){return Object(r.jsxs)("footer",{className:"d-flex flex-wrap justify-content-between align-items-center py-3 mt-4 border-top",children:[Object(r.jsx)("div",{className:"col-md-4 d-flex align-items-center",children:Object(r.jsx)("span",{className:"text-muted",children:"\xa9 2021 anchored"})}),Object(r.jsx)("ul",{className:"nav col-md-4 justify-content-end list-unstyled d-flex",children:Object(r.jsx)("li",{className:"ms-3",children:Object(r.jsx)("a",{className:"text-muted",href:"https://github.com/HFSVBC/anchored",target:"_blank",rel:"noreferrer",children:Object(r.jsx)("i",{className:"bi-github",role:"img","aria-label":"GitHub",style:{fontSize:"1.75rem"}})})})})]})},m=l(10),b=l.n(m),h={fontSize:"1.75rem"},u=function(e){var t=e.imageMetadata,l=e.matches,a=Object(c.useState)(),i=Object(n.a)(a,2),s=i[0],d=i[1],o=Object(c.useState)(),j=Object(n.a)(o,2),m=j[0],u=j[1];Object(c.useEffect)((function(){var e=t.tags[0].split(":");d(e[1]),u(e[0])}),[t]);var x=function(e){return"".concat(b()("vulnerability",e,!0)," found")};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"row pt-4",children:Object(r.jsxs)("div",{className:"col-md-10",children:[Object(r.jsx)("h5",{className:"mb-0",children:m}),Object(r.jsx)("p",{className:"text-muted",children:"".concat(s," - ").concat(b()("layer",t.layers.length,!0))})]})}),Object(r.jsxs)("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4 py-5",children:[Object(r.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(r.jsx)("i",{className:"bi-exclamation-triangle-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Triangle",style:h}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{className:"fw-bold mb-0",children:"Critical"}),Object(r.jsx)("p",{children:x(l.critical.length)})]})]}),Object(r.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(r.jsx)("i",{className:"bi-exclamation-diamond-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Diamond",style:h}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{className:"fw-bold mb-0",children:"Danger"}),Object(r.jsx)("p",{children:x(l.high.length)})]})]}),Object(r.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(r.jsx)("i",{className:"bi-exclamation-circle-fill text-warning flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Circle",style:h}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{className:"fw-bold mb-0",children:"Medium"}),Object(r.jsx)("p",{children:x(l.medium.length)})]})]}),Object(r.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(r.jsx)("i",{className:"bi-info-square-fill text-muted flex-shrink-0 me-3",role:"img","aria-label":"Info Square",style:h}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{className:"fw-bold mb-0",children:"Low / Negligible"}),Object(r.jsx)("p",{children:x(l.low.length+l.negligible.length)})]})]})]})]})},x=l(4),O=function(e){var t,l,c,a,i,s,n,d,o,j,m,b,h,u,x,O,v,f,g,N=e.vulnerability;return Object(r.jsx)("div",{className:"modal fade",id:"vulnarabilityDeatilsModal",tabIndex:"-1","aria-labelledby":"vulnarabilityDeatilsModal","aria-hidden":"true",children:Object(r.jsx)("div",{className:"modal-dialog modal-dialog-scrollable modal-lg",children:Object(r.jsxs)("div",{className:"modal-content",children:[Object(r.jsxs)("div",{className:"modal-header",children:[Object(r.jsx)("h5",{className:"modal-title",id:"vulnarabilityDeatilsModal",children:null===N||void 0===N||null===(t=N.vulnerability)||void 0===t?void 0:t.id}),Object(r.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(r.jsx)("div",{className:"modal-body",children:Object(r.jsxs)("dl",{className:"row",children:[Object(r.jsx)("dt",{className:"col-sm-3"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("h5",{children:"Vulnerability"})}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Severity"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(l=N.vulnerability)||void 0===l?void 0:l.severity}),(null===N||void 0===N||null===(c=N.vulnerability)||void 0===c?void 0:c.description)?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("dt",{className:"col-sm-3",children:"Description"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(a=N.vulnerability)||void 0===a?void 0:a.description})]}):"",Object(r.jsx)("dt",{className:"col-sm-3",children:"Links"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("ul",{className:"ps-3 mb-0",children:null===N||void 0===N||null===(i=N.vulnerability)||void 0===i?void 0:i.links.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:e})},e)}))})}),Object(r.jsx)("hr",{}),Object(r.jsx)("dt",{className:"col-sm-3"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("h5",{children:"Match Details"})}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Matcher"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(s=N.matchDetails)||void 0===s?void 0:s.matcher}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Matched On"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("code",{children:null===N||void 0===N||null===(n=N.matchDetails)||void 0===n||null===(d=n.matchedOn)||void 0===d?void 0:d.constraint})}),Object(r.jsx)("hr",{}),Object(r.jsx)("dt",{className:"col-sm-3"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("h5",{children:"Artifact"})}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Name"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(o=N.artifact)||void 0===o?void 0:o.name}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Version"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(j=N.artifact)||void 0===j?void 0:j.version}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Type"}),Object(r.jsx)("dd",{className:"col-sm-9",children:null===N||void 0===N||null===(m=N.artifact)||void 0===m?void 0:m.type}),(null===N||void 0===N||null===(b=N.artifact)||void 0===b||null===(h=b.metadata)||void 0===h?void 0:h.homepage)?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("dt",{className:"col-sm-3",children:"Homepage"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("a",{href:null===N||void 0===N||null===(u=N.artifact)||void 0===u||null===(x=u.metadata)||void 0===x?void 0:x.homepage,target:"_blank",rel:"noreferrer",children:null===N||void 0===N||null===(O=N.artifact)||void 0===O||null===(v=O.metadata)||void 0===v?void 0:v.homepage})})]}):"",Object(r.jsx)("dt",{className:"col-sm-3",children:"Licenses"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("ul",{className:"ps-3 mb-0",children:null===N||void 0===N||null===(f=N.artifact)||void 0===f?void 0:f.licenses.map((function(e){return Object(r.jsx)("li",{children:e},e)}))})}),Object(r.jsx)("dt",{className:"col-sm-3",children:"Locations"}),Object(r.jsx)("dd",{className:"col-sm-9",children:Object(r.jsx)("ul",{className:"ps-3 mb-0",children:null===N||void 0===N||null===(g=N.artifact)||void 0===g?void 0:g.locations.map((function(e){return Object(r.jsxs)("li",{children:["Layer\xa0",null===e||void 0===e?void 0:e.layerIndex,"\xa0-\xa0",Object(r.jsx)("code",{children:null===e||void 0===e?void 0:e.path})]},e.path)}))})})]})})]})})})};O.defaultProps={vulnerability:{}};var v=O,f=function(e){var t=e.value,l=e.data,c=e.onVulnerabilityIdClick;return Object(r.jsx)("button",{type:"button",className:"btn btn-link","data-bs-toggle":"modal","data-bs-target":"#vulnarabilityDeatilsModal",onClick:function(){c(l)},children:t})},g=function(e){var t=e.value,l="text-body";switch(t){case"High":case"Critical":l="text-danger";break;case"Medium":l="text-warning";break;default:l="text-body"}return Object(r.jsx)("span",{className:l,children:t})},N=l(3),p={minHeight:"480px",width:"100%"},y={filter:"agTextColumnFilter",resizable:!0},k={idCell:f,severityCell:g,severityFilter:Object(c.forwardRef)((function(e,t){var l=Object(c.useState)([]),a=Object(n.a)(l,2),i=a[0],s=a[1];Object(c.useImperativeHandle)(t,(function(){return{doesFilterPass:function(t){var l=!0,c=e.valueGetter(t);return i.length>0&&i.indexOf(c.toString().toLowerCase())<0&&(l=!1),l},isFilterActive:function(){return i>[]},getModel:function(){return{value:i}},setModel:function(e){s(e.value)}}}));var d=function(e){if(e.target.checked){var t=Object(N.a)(i);t.push(e.target.value),s(t)}else s(i.filter((function(t){return t!==e.target.value})))};return Object(c.useEffect)((function(){e.filterChangedCallback()}),[i]),Object(r.jsxs)("div",{className:"ag-filter-body-wrapper ag-simple-filter-body-wrapper",children:[Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"checkbox",value:"critical",id:"severityCriticalCheck",onChange:d}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"severityCriticalCheck",children:"Critical"})]}),Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"checkbox",value:"high",id:"severityHighCheck",onChange:d}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"severityHighCheck",children:"High"})]}),Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"checkbox",value:"medium",id:"severityMediumCheck",onChange:d}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"severityMediumCheck",children:"Medium"})]}),Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"checkbox",value:"low",id:"severityLowCheck",onChange:d}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"severityLowCheck",children:"Low"})]}),Object(r.jsxs)("div",{className:"form-check",children:[Object(r.jsx)("input",{className:"form-check-input",type:"checkbox",value:"negligible",id:"severityNegligibleCheck",onChange:d}),Object(r.jsx)("label",{className:"form-check-label",htmlFor:"severityNegligibleCheck",children:"Negligible"})]})]})}))},C=function(e){return e.data.artifact.locations[0].layerIndex},w=function(e){var t=e.matches,l=Object(c.useState)(),a=Object(n.a)(l,2),i=a[0],s=a[1],d=Object(c.useState)(),o=Object(n.a)(d,2),j=o[0],m=o[1];Object(c.useEffect)((function(){s(t.critical.concat(t.high).concat(t.medium).concat(t.low).concat(t.negligible))}),[t]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"ag-theme-alpine flex-grow-1",style:p,children:Object(r.jsxs)(x.AgGridReact,{rowData:i,paginationAutoPageSize:"true",pagination:"true",defaultColDef:y,frameworkComponents:k,onGridReady:function(e){e.api.sizeColumnsToFit()},children:[Object(r.jsxs)(x.AgGridColumn,{headerName:"Vulnerability",children:[Object(r.jsx)(x.AgGridColumn,{headerName:"ID",field:"vulnerability.id",minWidth:190,cellRenderer:"idCell",cellRendererParams:{onVulnerabilityIdClick:function(e){m(e)}}}),Object(r.jsx)(x.AgGridColumn,{headerName:"Severity",field:"vulnerability.severity",minWidth:120,sortable:"true",cellRenderer:"severityCell",filter:"severityFilter"}),Object(r.jsx)(x.AgGridColumn,{headerName:"Description",field:"vulnerability.description",minWidth:500})]}),Object(r.jsxs)(x.AgGridColumn,{headerName:"Artifact",children:[Object(r.jsx)(x.AgGridColumn,{headerName:"Type",field:"artifact.type"}),Object(r.jsx)(x.AgGridColumn,{headerName:"Package",field:"artifact.name"}),Object(r.jsx)(x.AgGridColumn,{headerName:"Version",field:"artifact.version"})]}),Object(r.jsx)(x.AgGridColumn,{headerName:"Layer",children:Object(r.jsx)(x.AgGridColumn,{headerName:"Index",valueGetter:C,sortable:"true",sort:"desc"})})]})}),Object(r.jsx)(v,{vulnerability:j})]})},F=function(){return Object(r.jsxs)("div",{className:"px-4 py-5 my-5 text-center",children:[Object(r.jsxs)("h1",{className:"display-5 fw-bold",children:["Please Load a",Object(r.jsx)("i",{children:" vulnerabilities.json "}),"File"]}),Object(r.jsx)("div",{className:"col-lg-6 mx-auto",children:Object(r.jsxs)("p",{className:"lead mb-4 text-muted",children:["The",Object(r.jsx)("i",{children:" vulnerabilities.json "}),"report is generated by the anchore engine. For more information on the anchore engine please visit:\xa0",Object(r.jsx)("a",{className:"text-muted",href:"https://anchore.com",target:"_blank",rel:"noreferrer",children:"anchore.com"})]})})]})};var M={bytesToSize:function(e){if(0===e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return"".concat(Math.round(e/Math.pow(1024,t),2)," ").concat(["Bytes","KB","MB","GB","TB"][t])},layerMatchesBySeverity:function(e,t){return e.filter((function(e){return e.vulnerability.severity.toLowerCase()===t}))},parseMatches:function(e){var t={negligible:[],low:[],medium:[],high:[],critical:[]};return Object.keys(t).forEach((function(l){t[l]=e.matches.filter((function(e){return e.vulnerability.severity.toLowerCase()===l}))})),t}};l(30);var S=function(){var e=Object(c.useState)(),t=Object(n.a)(e,2),l=t[0],a=t[1],i=Object(c.useState)(),s=Object(n.a)(i,2),d=s[0],m=s[1];return Object(r.jsxs)("main",{className:"App d-flex flex-column",children:[Object(r.jsx)("div",{className:"w-100",children:Object(r.jsx)(o,{handleFileLoad:function(e){a(e.image),m(M.parseMatches(e))}})}),Object(r.jsxs)("div",{className:"container d-flex align-items-end flex-column flex-grow-1",children:[Object(r.jsx)("div",{className:"w-100 h-100 d-flex flex-column",children:l&&d?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(u,{imageMetadata:l,matches:d}),Object(r.jsx)(w,{matches:d})]}):Object(r.jsx)(F,{})}),Object(r.jsx)("div",{className:"w-100 mt-auto",children:Object(r.jsx)(j,{})})]})]})};l(31);s.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(S,{})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.1ca25a4a.chunk.js.map