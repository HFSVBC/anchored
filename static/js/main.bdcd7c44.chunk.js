(this.webpackJsonpanchored=this.webpackJsonpanchored||[]).push([[0],{30:function(e,t,c){},32:function(e,t,c){"use strict";c.r(t);var a=c(1),i=c.n(a),l=c(8),r=c.n(l),s=c(2),n=c(0),o=function(e){var t=e.handleFileLoad,c=Object(a.useState)(),i=Object(s.a)(c,2),l=i[0],r=i[1];return Object(n.jsx)("form",{className:"d-flex",onSubmit:function(e){if(e.preventDefault(),l){var c=new FileReader;c.onload=function(e){t(JSON.parse(e.target.result))},c.readAsText(l)}else alert("No file selected!")},children:Object(n.jsx)("div",{className:"form-group",children:Object(n.jsxs)("div",{className:"input-group",children:[Object(n.jsx)("input",{type:"file",onChange:function(e){return r(e.target.files[0])},accept:"application/JSON",className:"form-control",id:"inputGroupFile","aria-describedby":"inputGroupFileAddon","aria-label":"Upload",required:!0}),Object(n.jsx)("button",{className:"btn btn-outline-primary",type:"submit",id:"inputGroupFileAddon",children:"Load"})]})})})},d=function(e){var t=e.handleFileLoad;return Object(n.jsx)("header",{className:"p-3 mb-3 border-bottom",children:Object(n.jsx)("div",{className:"container",children:Object(n.jsxs)("div",{className:"d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start",children:[Object(n.jsx)("a",{href:"/",className:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",children:Object(n.jsx)("span",{className:"fs-4",children:"anchored"})}),Object(n.jsx)(o,{handleFileLoad:t})]})})})},j=function(){return Object(n.jsxs)("footer",{className:"d-flex flex-wrap justify-content-between align-items-center py-3 mt-4 border-top",children:[Object(n.jsx)("div",{className:"col-md-4 d-flex align-items-center",children:Object(n.jsx)("span",{className:"text-muted",children:"\xa9 2021 anchored"})}),Object(n.jsx)("ul",{className:"nav col-md-4 justify-content-end list-unstyled d-flex",children:Object(n.jsx)("li",{className:"ms-3",children:Object(n.jsx)("a",{className:"text-muted",href:"https://github.com/HFSVBC/anchored",target:"_blank",rel:"noreferrer",children:Object(n.jsx)("i",{className:"bi-github",role:"img","aria-label":"GitHub",style:{fontSize:"1.75rem"}})})})})]})},m=c(10),b=c.n(m),h={fontSize:"1.75rem"},u=function(e){var t=e.imageMetadata,c=e.matches,i=Object(a.useState)(),l=Object(s.a)(i,2),r=l[0],o=l[1],d=Object(a.useState)(),j=Object(s.a)(d,2),m=j[0],u=j[1];Object(a.useEffect)((function(){var e=t.tags[0].split(":");o(e[1]),u(e[0])}),[t]);var x=function(e){return"".concat(b()("vulnerability",e,!0)," found")};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"row pt-4",children:Object(n.jsxs)("div",{className:"col-md-10",children:[Object(n.jsx)("h5",{className:"mb-0",children:m}),Object(n.jsx)("p",{className:"text-muted",children:"".concat(r," - ").concat(b()("layer",t.layers.length,!0))})]})}),Object(n.jsxs)("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4 py-5",children:[Object(n.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(n.jsx)("i",{className:"bi-exclamation-triangle-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Triangle",style:h}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{className:"fw-bold mb-0",children:"Critical"}),Object(n.jsx)("p",{children:x(c.critical.length)})]})]}),Object(n.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(n.jsx)("i",{className:"bi-exclamation-diamond-fill text-danger flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Diamond",style:h}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{className:"fw-bold mb-0",children:"Danger"}),Object(n.jsx)("p",{children:x(c.high.length)})]})]}),Object(n.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(n.jsx)("i",{className:"bi-exclamation-circle-fill text-warning flex-shrink-0 me-3",role:"img","aria-label":"Exclamation Circle",style:h}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{className:"fw-bold mb-0",children:"Medium"}),Object(n.jsx)("p",{children:x(c.medium.length)})]})]}),Object(n.jsxs)("div",{className:"col d-flex align-items-start",children:[Object(n.jsx)("i",{className:"bi-info-square-fill text-muted flex-shrink-0 me-3",role:"img","aria-label":"Info Square",style:h}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{className:"fw-bold mb-0",children:"Low / Negligible"}),Object(n.jsx)("p",{children:x(c.low.length+c.negligible.length)})]})]})]})]})},x=c(4),f=function(e){var t=e.value,c="text-body";switch(t){case"High":case"Critical":c="text-danger";break;case"Medium":c="text-warning";break;default:c="text-body"}return Object(n.jsx)("span",{className:c,children:t})},O=c(3),g={minHeight:"480px",width:"100%"},v={filter:"agTextColumnFilter",resizable:!0},p={severityCell:f,severityFilter:Object(a.forwardRef)((function(e,t){var c=Object(a.useState)([]),i=Object(s.a)(c,2),l=i[0],r=i[1];Object(a.useImperativeHandle)(t,(function(){return{doesFilterPass:function(t){var c=!0,a=e.valueGetter(t);return l.length>0&&l.indexOf(a.toString().toLowerCase())<0&&(c=!1),c},isFilterActive:function(){return l>[]},getModel:function(){return{value:l}},setModel:function(e){r(e.value)}}}));var o=function(e){if(e.target.checked){var t=Object(O.a)(l);t.push(e.target.value),r(t)}else r(l.filter((function(t){return t!==e.target.value})))};return Object(a.useEffect)((function(){e.filterChangedCallback()}),[l]),Object(n.jsxs)("div",{className:"ag-filter-body-wrapper ag-simple-filter-body-wrapper",children:[Object(n.jsxs)("div",{className:"form-check",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",value:"critical",id:"severityCriticalCheck",onChange:o}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"severityCriticalCheck",children:"Critical"})]}),Object(n.jsxs)("div",{className:"form-check",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",value:"high",id:"severityHighCheck",onChange:o}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"severityHighCheck",children:"High"})]}),Object(n.jsxs)("div",{className:"form-check",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",value:"medium",id:"severityMediumCheck",onChange:o}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"severityMediumCheck",children:"Medium"})]}),Object(n.jsxs)("div",{className:"form-check",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",value:"low",id:"severityLowCheck",onChange:o}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"severityLowCheck",children:"Low"})]}),Object(n.jsxs)("div",{className:"form-check",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",value:"negligible",id:"severityNegligibleCheck",onChange:o}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"severityNegligibleCheck",children:"Negligible"})]})]})}))},N=function(e){return e.data.artifact.locations[0].layerIndex},y=function(e){var t=e.matches,c=Object(a.useState)(),i=Object(s.a)(c,2),l=i[0],r=i[1];Object(a.useEffect)((function(){r(t.critical.concat(t.high).concat(t.medium).concat(t.low).concat(t.negligible))}),[t]);return Object(n.jsx)("div",{className:"ag-theme-alpine flex-grow-1",style:g,children:Object(n.jsxs)(x.AgGridReact,{rowData:l,paginationAutoPageSize:"true",pagination:"true",defaultColDef:v,frameworkComponents:p,onGridReady:function(e){e.api.sizeColumnsToFit()},children:[Object(n.jsxs)(x.AgGridColumn,{headerName:"Vulnerability",children:[Object(n.jsx)(x.AgGridColumn,{headerName:"ID",field:"vulnerability.id",minWidth:190}),Object(n.jsx)(x.AgGridColumn,{headerName:"Severity",field:"vulnerability.severity",minWidth:120,sortable:"true",cellRenderer:"severityCell",filter:"severityFilter"}),Object(n.jsx)(x.AgGridColumn,{headerName:"Description",field:"vulnerability.description",minWidth:500})]}),Object(n.jsxs)(x.AgGridColumn,{headerName:"Artifact",children:[Object(n.jsx)(x.AgGridColumn,{headerName:"Type",field:"artifact.type"}),Object(n.jsx)(x.AgGridColumn,{headerName:"Package",field:"artifact.name"}),Object(n.jsx)(x.AgGridColumn,{headerName:"Version",field:"artifact.version"})]}),Object(n.jsx)(x.AgGridColumn,{headerName:"Layer",children:Object(n.jsx)(x.AgGridColumn,{headerName:"Index",valueGetter:N,sortable:"true",sort:"desc"})})]})})},k=function(){return Object(n.jsxs)("div",{className:"px-4 py-5 my-5 text-center",children:[Object(n.jsxs)("h1",{className:"display-5 fw-bold",children:["Please Load a",Object(n.jsx)("i",{children:" vulnerabilities.json "}),"File"]}),Object(n.jsx)("div",{className:"col-lg-6 mx-auto",children:Object(n.jsxs)("p",{className:"lead mb-4 text-muted",children:["The",Object(n.jsx)("i",{children:" vulnerabilities.json "}),"report is generated by the anchore engine. For more information on the anchore engine please visit:\xa0",Object(n.jsx)("a",{className:"text-muted",href:"https://anchore.com",target:"_blank",rel:"noreferrer",children:"anchore.com"})]})})]})};var C={bytesToSize:function(e){if(0===e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return"".concat(Math.round(e/Math.pow(1024,t),2)," ").concat(["Bytes","KB","MB","GB","TB"][t])},layerMatchesBySeverity:function(e,t){return e.filter((function(e){return e.vulnerability.severity.toLowerCase()===t}))},parseMatches:function(e){var t={negligible:[],low:[],medium:[],high:[],critical:[]};return Object.keys(t).forEach((function(c){t[c]=e.matches.filter((function(e){return e.vulnerability.severity.toLowerCase()===c}))})),t}};c(30);var w=function(){var e=Object(a.useState)(),t=Object(s.a)(e,2),c=t[0],i=t[1],l=Object(a.useState)(),r=Object(s.a)(l,2),o=r[0],m=r[1];return Object(n.jsxs)("main",{className:"App d-flex flex-column",children:[Object(n.jsx)("div",{className:"w-100",children:Object(n.jsx)(d,{handleFileLoad:function(e){i(e.image),m(C.parseMatches(e))}})}),Object(n.jsxs)("div",{className:"container d-flex align-items-end flex-column flex-grow-1",children:[Object(n.jsx)("div",{className:"w-100 h-100 d-flex flex-column",children:c&&o?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(u,{imageMetadata:c,matches:o}),Object(n.jsx)(y,{matches:o})]}):Object(n.jsx)(k,{})}),Object(n.jsx)("div",{className:"w-100 mt-auto",children:Object(n.jsx)(j,{})})]})]})};c(31);r.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(w,{})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.bdcd7c44.chunk.js.map